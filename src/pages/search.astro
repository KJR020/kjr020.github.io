---
import PageHero from "@/components/PageHero.astro";
import BaseLayout from "@/layouts/BaseLayout.astro";
---

<BaseLayout title="Search - KJR020's Blog" description="記事を検索">
  <PageHero title="Search" description="サイト内の記事を検索できます。" />
  <div class="container mx-auto px-4 pb-phi-2xl">
    <div id="search"></div>
  </div>
</BaseLayout>

<link href="/pagefind/pagefind-ui.css" rel="stylesheet" />

<style is:global>
  :root {
    --pagefind-ui-scale: 1.1;
    --pagefind-ui-primary: var(--primary);
    --pagefind-ui-text: var(--foreground);
    --pagefind-ui-background: var(--muted);
    --pagefind-ui-border: var(--border);
    --pagefind-ui-tag: var(--secondary);
    --pagefind-ui-border-width: 1px;
    --pagefind-ui-border-radius: 0.618rem;
    --pagefind-ui-font: inherit;
  }

  .pagefind-ui__search-input {
    background-color: var(--muted) !important;
    border-color: var(--border) !important;
    color: var(--foreground) !important;
    font-weight: normal !important;
    transition:
      border-color 0.2s,
      box-shadow 0.2s !important;
  }

  .pagefind-ui__search-input:focus {
    border-color: var(--muted-foreground) !important;
    box-shadow: 0 0 0 1px color-mix(in srgb, var(--ring) 15%, transparent) !important;
    outline: none !important;
  }

  .dark .pagefind-ui__search-input {
    background-color: var(--card) !important;
  }

  .pagefind-ui__search-input::placeholder {
    color: var(--muted-foreground) !important;
  }

  .pagefind-ui__result {
    background-color: var(--card) !important;
    border-color: var(--border) !important;
  }

  .pagefind-ui__result-link {
    color: var(--link) !important;
    text-decoration: none !important;
    transition: color 0.15s !important;
  }

  .pagefind-ui__result-link:hover {
    color: var(--link-hover) !important;
  }

  .pagefind-ui__result-excerpt {
    color: var(--muted-foreground) !important;
  }

  .pagefind-ui__message {
    color: var(--muted-foreground) !important;
  }

  /* クリアボタン */
  .pagefind-ui__search-clear {
    background-color: transparent !important;
    color: var(--muted-foreground) !important;
    border: 1px solid var(--border) !important;
    border-radius: calc(var(--radius) - 2px) !important;
    padding: 0 calc(12px * var(--pagefind-ui-scale)) !important;
    height: calc(40px * var(--pagefind-ui-scale)) !important;
    font-size: var(--font-size-small) !important;
    cursor: pointer !important;
    transition:
      background-color 0.15s,
      color 0.15s !important;
  }

  .pagefind-ui__search-clear:hover {
    background-color: var(--accent) !important;
    color: var(--accent-foreground) !important;
  }

  .pagefind-ui__search-clear:focus-visible {
    outline: 1px solid var(--ring) !important;
    outline-offset: 1px !important;
  }
</style>

<script is:inline>
  window.addEventListener("DOMContentLoaded", () => {
    const script = document.createElement("script");
    script.src = "/pagefind/pagefind-ui.js";
    script.onload = () => {
      new window.PagefindUI({
        element: "#search",
        showSubResults: true,
        translations: {
          placeholder: "記事を検索...",
          zero_results: "検索結果が見つかりませんでした",
        },
      });
    };
    document.head.appendChild(script);
  });
</script>
