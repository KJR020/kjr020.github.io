@import "tailwindcss";

:root {
  --background: hsl(0 0% 100%);
  --foreground: hsl(240 10% 3.9%);
  --link: hsl(230 70% 50%);
  --link-hover: hsl(230 70% 40%);
  --font-heading: "Noto Sans JP", system-ui, -apple-system, sans-serif;
  --font-mono: "JetBrains Mono", ui-monospace, "SFMono-Regular", "Menlo", "Monaco", "Consolas", monospace;
  --card: hsl(0 0% 100%);
  --card-foreground: hsl(240 10% 3.9%);
  --popover: hsl(0 0% 100%);
  --popover-foreground: hsl(240 10% 3.9%);
  --primary: hsl(240 5.9% 10%);
  --primary-foreground: hsl(0 0% 98%);
  --secondary: hsl(240 4.8% 95.9%);
  --secondary-foreground: hsl(240 5.9% 10%);
  --muted: hsl(240 4.8% 95.9%);
  --muted-foreground: hsl(240 3.8% 46.1%);
  --accent: hsl(240 4.8% 95.9%);
  --accent-foreground: hsl(240 5.9% 10%);
  --destructive: hsl(0 84.2% 60.2%);
  --destructive-foreground: hsl(0 0% 98%);
  --border: hsl(240 5.9% 90%);
  --input: hsl(240 5.9% 90%);
  --ring: hsl(240 5.9% 10%);
  --radius: 0.618rem; /* 1/φ (golden ratio) */

  /* Golden Ratio Design Tokens (φ = 1.618033...) */
  --phi: 1.618;

  /* φ Power Scale (rem) */
  --phi-neg3: 0.236rem;  /* φ⁻³ */
  --phi-neg2: 0.382rem;  /* φ⁻² */
  --phi-neg1: 0.618rem;  /* φ⁻¹ */
  --phi-0: 1rem;         /* φ⁰ */
  --phi-1: 1.618rem;     /* φ¹ */
  --phi-2: 2.618rem;     /* φ² */
  --phi-3: 4.236rem;     /* φ³ */
  --phi-4: 6.854rem;     /* φ⁴ */
  --phi-5: 11.09rem;     /* φ⁵ */
  --phi-6: 17.94rem;     /* φ⁶ */
  --phi-7: 29.03rem;     /* φ⁷ */

  /* Typography Scale */
  --font-size-display: 2.618rem; /* φ² */
  --font-size-title1: 2.058rem; /* φ×√φ */
  --font-size-title2: 1.618rem; /* φ */
  --font-size-title3: 1.272rem; /* √φ */
  --font-size-body: 1rem;
  --font-size-small: 0.886rem; /* 1/⁴√φ */
  --font-size-caption: 0.786rem; /* 1/√φ */

  /* Line Heights */
  --lh-tight: 1.272; /* √φ — headings */
  --lh-body: 1.618; /* φ — body text */

  /* Callout Colors - Note (sky) */
  --callout-note: hsl(199 89% 48%);

  /* Callout Colors - Tip (emerald) */
  --callout-tip: hsl(160 84% 39%);

  /* Callout Colors - Warning (amber) */
  --callout-warning: hsl(38 92% 50%);

  /* Callout Colors - Danger (rose) */
  --callout-danger: hsl(350 89% 60%);
}

.dark {
  --background: hsl(225 12% 7%);
  --foreground: hsl(0 0% 98%);
  --card: hsl(225 10% 10%);
  --link: hsl(225 75% 65%);
  --link-hover: hsl(225 75% 75%);
  --card-foreground: hsl(0 0% 98%);
  --popover: hsl(240 10% 3.9%);
  --popover-foreground: hsl(0 0% 98%);
  --primary: hsl(0 0% 98%);
  --primary-foreground: hsl(240 5.9% 10%);
  --secondary: hsl(240 3.7% 15.9%);
  --secondary-foreground: hsl(0 0% 98%);
  --muted: hsl(240 3.7% 15.9%);
  --muted-foreground: hsl(240 5% 64.9%);
  --accent: hsl(240 3.7% 15.9%);
  --accent-foreground: hsl(0 0% 98%);
  --destructive: hsl(0 62.8% 30.6%);
  --destructive-foreground: hsl(0 0% 98%);
  --border: hsl(240 3.7% 15.9%);
  --input: hsl(240 3.7% 15.9%);
  --ring: hsl(240 4.9% 83.9%);

  /* Callout Colors - Note (sky) */
  --callout-note: hsl(199 89% 48%);

  /* Callout Colors - Tip (emerald) */
  --callout-tip: hsl(160 84% 39%);

  /* Callout Colors - Warning (amber) */
  --callout-warning: hsl(38 92% 50%);

  /* Callout Colors - Danger (rose) */
  --callout-danger: hsl(350 89% 60%);
}

@theme inline {
  /* Golden Ratio Spacing (φ = 1.618) */
  --spacing-phi-3xs: 0.236rem; /* φ⁻³ */
  --spacing-phi-2xs: 0.382rem; /* φ⁻² */
  --spacing-phi-xs: 0.618rem; /* φ⁻¹ */
  --spacing-phi-sm: 0.786rem; /* 1/√φ */
  --spacing-phi-md: 1rem;
  --spacing-phi-lg: 1.272rem; /* √φ */
  --spacing-phi-xl: 1.618rem; /* φ */
  --spacing-phi-2xl: 2.618rem; /* φ² */
  --spacing-phi-3xl: 4.236rem; /* φ³ */

  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);
  --color-link: var(--link);
  --color-link-hover: var(--link-hover);
  --font-family-heading: var(--font-heading);
  --font-family-mono: var(--font-mono);
}

@layer base {
  * {
    border-color: var(--border);
  }
  body {
    background-color: var(--background);
    color: var(--foreground);
  }
}

/* Shiki dual themes support (defaultColor: false) */
/* ライトモード */
.astro-code {
  background-color: #f6f8fa !important; /* GitHub風のグレー背景 */
}

.astro-code span {
  color: var(--shiki-light) !important;
}

/* ダークモード */
.dark .astro-code {
  background-color: var(--shiki-dark-bg) !important;
}

.dark .astro-code span {
  color: var(--shiki-dark) !important;
}

/* ========================================
   remark-link-card スタイル
   ======================================== */

.rlc-container {
  --padding-x: 1rem;
  --padding-y: 0.7rem;
  --border-radius: calc(var(--radius) - 1px);

  border: 1px solid var(--border);
  border-radius: calc(var(--border-radius) + 1px);
  text-decoration: none !important;
  color: inherit !important;
  transition: background-color 150ms;
  width: 100%;
  margin-bottom: 1.25em;
  display: grid;
  grid-template-columns: 1fr 116px;
  gap: 1rem;
}

@media (min-width: 60ch) {
  .rlc-container {
    grid-template-columns: 1fr 220px;
  }
}

.rlc-container:hover {
  background-color: var(--secondary);
}

/* .prose a との競合を避ける */
.prose .rlc-container,
.rlc-container:visited {
  text-decoration: none !important;
  color: inherit !important;
}

/* テキスト情報エリア */
.rlc-info {
  display: flex;
  flex-direction: column;
  justify-content: center;
  font-weight: normal;
  grid-column: 1;
  padding: var(--padding-y) 0 var(--padding-y) var(--padding-x);
  max-width: 100%;
  min-width: 0;
  border-radius: var(--border-radius) 0 0 var(--border-radius);
}

.rlc-title {
  font-size: 1rem;
  font-weight: bold;
  line-height: 1.3;
  color: var(--card-foreground);
  overflow: hidden;
  display: -webkit-box;
  text-overflow: ellipsis;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
}

.rlc-description {
  font-size: 0.8rem;
  color: var(--muted-foreground);
  margin-bottom: 0.5em;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  -webkit-line-clamp: 1;
}

.rlc-url-container {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.rlc-favicon {
  margin-top: 0.15rem;
  margin-bottom: 0;
  width: 16px;
  height: 16px;
}

.rlc-url {
  font-size: 0.8rem;
  color: var(--muted-foreground);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  -webkit-line-clamp: 1;
}

/* OG画像エリア */
.rlc-image-container {
  grid-column: 2;
  aspect-ratio: 1 / 1;
}

@media (min-width: 60ch) {
  .rlc-image-container {
    aspect-ratio: 1.91 / 1;
  }
}

.rlc-image {
  object-fit: cover;
  height: 100%;
  width: 100%;
  margin: 0;
  border-radius: 0 var(--border-radius) var(--border-radius) 0;
}

/* OG画像なし時のフォールバック: ドメインアイコン表示 */
.rlc-container:not(:has(.rlc-image-container))::after {
  content: "";
  grid-column: 2;
  background-color: var(--muted);
  border-radius: 0 var(--border-radius) var(--border-radius) 0;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20'/%3E%3Cpath d='M2 12h20'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: center;
  background-size: 2rem;
  opacity: 0.5;
}

/* OG画像エラー時: 壊れた画像をフォールバックに置換 */
.rlc-image[src=""] {
  display: none;
}

.rlc-image-container:has(.rlc-image[src=""]) {
  background-color: var(--muted);
  border-radius: 0 var(--border-radius) var(--border-radius) 0;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20'/%3E%3Cpath d='M2 12h20'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: center;
  background-size: 2rem;
  opacity: 0.5;
}

/* ダークモード対応 */
.dark .rlc-container:hover {
  background-color: var(--secondary);
}

.dark .rlc-title {
  color: var(--card-foreground);
}

.dark .rlc-description,
.dark .rlc-url {
  color: var(--muted-foreground);
}

.dark .rlc-container:not(:has(.rlc-image-container))::after,
.dark .rlc-image-container:has(.rlc-image[src=""]) {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20'/%3E%3Cpath d='M2 12h20'/%3E%3C/svg%3E");
}

/* ========================================
   remark-callout スタイル
   ======================================== */

/* Base Callout Styles */
[data-callout] {
  margin: 1.5em 0;
  padding: 1rem 1.25rem;
  border-left: 2px solid var(--border);
}

[data-callout-title] {
  font-weight: 500;
  font-size: 0.875rem;
  margin-bottom: 0.25rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

[data-callout-body] {
  color: var(--muted-foreground);
  font-size: 0.875rem;
}

[data-callout-body] > *:last-child {
  margin-bottom: 0;
}

/* Callout内のリストスタイル調整 */
[data-callout-body] ul,
[data-callout-body] ol {
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
  padding-left: 1.5rem;
}

/* Callout内のコードブロック調整 */
[data-callout-body] pre {
  margin-top: 0.75rem;
  margin-bottom: 0.75rem;
}

/* Type-specific Styles - Minimal with transparency */
[data-callout-type="note"] {
  border-left-color: hsl(199 89% 48% / 0.6);
}

[data-callout-type="note"] [data-callout-title] {
  color: hsl(199 89% 48% / 0.9);
}

[data-callout-type="tip"] {
  border-left-color: hsl(160 84% 39% / 0.6);
}

[data-callout-type="tip"] [data-callout-title] {
  color: hsl(160 84% 39% / 0.9);
}

[data-callout-type="warning"] {
  border-left-color: hsl(38 92% 50% / 0.6);
}

[data-callout-type="warning"] [data-callout-title] {
  color: hsl(38 92% 50% / 0.9);
}

[data-callout-type="danger"] {
  border-left-color: hsl(350 89% 60% / 0.6);
}

[data-callout-type="danger"] [data-callout-title] {
  color: hsl(350 89% 60% / 0.9);
}

/* Page-load animation */
@keyframes fade-in-up {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade-in-up {
  animation: fade-in-up 0.4s ease-out both;
}

@media (prefers-reduced-motion: reduce) {
  .animate-fade-in-up {
    animation: none;
  }
}
